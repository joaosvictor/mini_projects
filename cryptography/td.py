# TODO: optimize the window with numpy
